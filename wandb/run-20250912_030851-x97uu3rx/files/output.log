开始模型评估...
使用数据集: dataset/sft_aviationqa.jsonl
加载了 1000 条测试数据
生成预测和评估:   5% 49/1000 [00:18<05:19,  2.98it/s]

=== 示例 1 ===
输入: What is the Distance from Accident Site of the accident no. ERA16FA012?
参考答案: 4 Nautical Miles
模型预测: 0 Nautical Miles
--------------------------------------------------

=== 示例 2 ===
输入: What was the Total Injuries accident no. CEN22LA071?
参考答案: 2 Serious
模型预测: 1 None
--------------------------------------------------

=== 示例 3 ===
输入: What was the Altimeter Setting of the accident no. GAA19CA276?
参考答案: 30.27 inches Hg
模型预测: 30.05 inches Hg
--------------------------------------------------

=== 示例 4 ===
输入: What was the Publish Date of the accident no. ANC14RA051?
参考答案: November 3, 2020
模型预测: May 21, 2022
--------------------------------------------------

=== 示例 5 ===
输入: What are the Probable Causes of the accident no. GAA15CA017?
参考答案: The pilot's failure to maintain directional/pitch control during final approach, resulting in a collision with terrain.
模型预测: The pilot’s failure to maintain directional control during the landing roll.
--------------------------------------------------

正在计算批次 1 的评估指标...

============================================================
批次 1 评估结果 (已处理 50 条)
============================================================
精确匹配准确率:     0.2800
Token级准确率:      0.1270
BLEU分数:          0.1859
ROUGE-1 F1:        0.4596
ROUGE-2 F1:        0.1898
ROUGE-L F1:        0.4593
语义相似度:         0.4235
平均预测长度:       4.86 词
平均参考长度:       9.86 词
长度比率:          0.4929
============================================================

正在计算批次 2 的评估指标...

============================================================
批次 2 评估结果 (已处理 100 条)
============================================================
精确匹配准确率:     0.2200
Token级准确率:      0.1615
BLEU分数:          0.1619
ROUGE-1 F1:        0.4218
ROUGE-2 F1:        0.2176
ROUGE-L F1:        0.4211
语义相似度:         0.3762
平均预测长度:       5.04 词
平均参考长度:       7.34 词
长度比率:          0.6866
============================================================

正在计算批次 3 的评估指标...

============================================================
批次 3 评估结果 (已处理 150 条)
============================================================
精确匹配准确率:     0.2867
Token级准确率:      0.1403
BLEU分数:          0.1788
ROUGE-1 F1:        0.4702
ROUGE-2 F1:        0.2268
ROUGE-L F1:        0.4668
语义相似度:         0.4255
平均预测长度:       5.52 词
平均参考长度:       8.67 词
长度比率:          0.6364
============================================================

正在计算批次 4 的评估指标...

============================================================
批次 4 评估结果 (已处理 200 条)
============================================================
精确匹配准确率:     0.3100
Token级准确率:      0.1685
BLEU分数:          0.1954
ROUGE-1 F1:        0.4789
ROUGE-2 F1:        0.2306
ROUGE-L F1:        0.4764
语义相似度:         0.4365
平均预测长度:       4.84 词
平均参考长度:       7.33 词
长度比率:          0.6603
============================================================

正在计算批次 5 的评估指标...

============================================================
批次 5 评估结果 (已处理 250 条)
============================================================
精确匹配准确率:     0.3080
Token级准确率:      0.1742
BLEU分数:          0.1909
ROUGE-1 F1:        0.4815
ROUGE-2 F1:        0.2199
ROUGE-L F1:        0.4786
语义相似度:         0.4375
平均预测长度:       4.74 词
平均参考长度:       6.98 词
长度比率:          0.6795
============================================================

正在计算批次 6 的评估指标...

============================================================
批次 6 评估结果 (已处理 300 条)
============================================================
精确匹配准确率:     0.2900
Token级准确率:      0.1742
BLEU分数:          0.1748
ROUGE-1 F1:        0.4497
ROUGE-2 F1:        0.1955
ROUGE-L F1:        0.4473
语义相似度:         0.4088
平均预测长度:       4.29 词
平均参考长度:       6.36 词
长度比率:          0.6737
============================================================

正在计算批次 7 的评估指标...

============================================================
批次 7 评估结果 (已处理 350 条)
============================================================
精确匹配准确率:     0.3029
Token级准确率:      0.1785
BLEU分数:          0.1752
ROUGE-1 F1:        0.4527
ROUGE-2 F1:        0.1883
ROUGE-L F1:        0.4504
语义相似度:         0.4135
平均预测长度:       4.15 词
平均参考长度:       6.03 词
长度比率:          0.6878
============================================================

正在计算批次 8 的评估指标...

============================================================
批次 8 评估结果 (已处理 400 条)
============================================================
精确匹配准确率:     0.3050
Token级准确率:      0.1845
BLEU分数:          0.1810
ROUGE-1 F1:        0.4584
ROUGE-2 F1:        0.1958
ROUGE-L F1:        0.4553
语义相似度:         0.4180
平均预测长度:       4.26 词
平均参考长度:       6.04 词
长度比率:          0.7057
============================================================

正在计算批次 9 的评估指标...

============================================================
批次 9 评估结果 (已处理 450 条)
============================================================
精确匹配准确率:     0.3044
Token级准确率:      0.1893
BLEU分数:          0.1848
ROUGE-1 F1:        0.4587
ROUGE-2 F1:        0.2011
ROUGE-L F1:        0.4558
语义相似度:         0.4185
平均预测长度:       4.32 词
平均参考长度:       6.16 词
长度比率:          0.7019
============================================================

正在计算批次 10 的评估指标...

============================================================
批次 10 评估结果 (已处理 500 条)
============================================================
精确匹配准确率:     0.3000
Token级准确率:      0.1947
BLEU分数:          0.1765
ROUGE-1 F1:        0.4501
ROUGE-2 F1:        0.1963
ROUGE-L F1:        0.4475
语义相似度:         0.4104
平均预测长度:       4.10 词
平均参考长度:       5.79 词
长度比率:          0.7081
============================================================

正在计算批次 11 的评估指标...

============================================================
批次 11 评估结果 (已处理 550 条)
============================================================
精确匹配准确率:     0.2945
Token级准确率:      0.1956
BLEU分数:          0.1720
ROUGE-1 F1:        0.4437
ROUGE-2 F1:        0.1893
ROUGE-L F1:        0.4412
语义相似度:         0.4037
平均预测长度:       4.11 词
平均参考长度:       5.73 词
长度比率:          0.7174
============================================================

正在计算批次 12 的评估指标...

============================================================
批次 12 评估结果 (已处理 600 条)
============================================================
精确匹配准确率:     0.2900
Token级准确率:      0.1894
BLEU分数:          0.1702
ROUGE-1 F1:        0.4486
ROUGE-2 F1:        0.1901
ROUGE-L F1:        0.4460
语义相似度:         0.4068
平均预测长度:       4.36 词
平均参考长度:       6.16 词
长度比率:          0.7076
============================================================

正在计算批次 13 的评估指标...

============================================================
批次 13 评估结果 (已处理 650 条)
============================================================
精确匹配准确率:     0.2892
Token级准确率:      0.1970
BLEU分数:          0.1683
ROUGE-1 F1:        0.4525
ROUGE-2 F1:        0.1861
ROUGE-L F1:        0.4498
语义相似度:         0.4094
平均预测长度:       4.29 词
平均参考长度:       5.93 词
长度比率:          0.7230
============================================================

正在计算批次 14 的评估指标...

============================================================
批次 14 评估结果 (已处理 700 条)
============================================================
精确匹配准确率:     0.2857
Token级准确率:      0.1991
BLEU分数:          0.1646
ROUGE-1 F1:        0.4479
ROUGE-2 F1:        0.1834
ROUGE-L F1:        0.4452
语义相似度:         0.4046
平均预测长度:       4.22 词
平均参考长度:       5.74 词
长度比率:          0.7359
============================================================

正在计算批次 15 的评估指标...

============================================================
批次 15 评估结果 (已处理 750 条)
============================================================
精确匹配准确率:     0.2880
Token级准确率:      0.2072
BLEU分数:          0.1670
ROUGE-1 F1:        0.4487
ROUGE-2 F1:        0.1844
ROUGE-L F1:        0.4458
语义相似度:         0.4061
平均预测长度:       4.12 词
平均参考长度:       5.54 词
长度比率:          0.7435
============================================================

正在计算批次 16 的评估指标...

============================================================
批次 16 评估结果 (已处理 800 条)
============================================================
精确匹配准确率:     0.2875
Token级准确率:      0.2110
BLEU分数:          0.1650
ROUGE-1 F1:        0.4478
ROUGE-2 F1:        0.1842
ROUGE-L F1:        0.4451
语义相似度:         0.4053
平均预测长度:       4.08 词
平均参考长度:       5.41 词
长度比率:          0.7547
============================================================

正在计算批次 17 的评估指标...

============================================================
批次 17 评估结果 (已处理 850 条)
============================================================
精确匹配准确率:     0.2835
Token级准确率:      0.2083
BLEU分数:          0.1605
ROUGE-1 F1:        0.4407
ROUGE-2 F1:        0.1760
ROUGE-L F1:        0.4381
语义相似度:         0.3995
平均预测长度:       4.04 词
平均参考长度:       5.33 词
长度比率:          0.7580
============================================================

正在计算批次 18 的评估指标...

============================================================
批次 18 评估结果 (已处理 900 条)
============================================================
精确匹配准确率:     0.2844
Token级准确率:      0.1965
BLEU分数:          0.1580
ROUGE-1 F1:        0.4368
ROUGE-2 F1:        0.1729
ROUGE-L F1:        0.4344
语义相似度:         0.3974
平均预测长度:       3.94 词
平均参考长度:       5.55 词
长度比率:          0.7091
============================================================

正在计算批次 19 的评估指标...

============================================================
批次 19 评估结果 (已处理 950 条)
============================================================
精确匹配准确率:     0.2821
Token级准确率:      0.2066
BLEU分数:          0.1604
ROUGE-1 F1:        0.4366
ROUGE-2 F1:        0.1756
ROUGE-L F1:        0.4343
语义相似度:         0.3965
平均预测长度:       4.15 词
平均参考长度:       5.63 词
长度比率:          0.7371
============================================================

正在计算批次 20 的评估指标...

============================================================
批次 20 评估结果 (已处理 1000 条)
============================================================
精确匹配准确率:     0.2830
Token级准确率:      0.1924
BLEU分数:          0.1603
ROUGE-1 F1:        0.4376
ROUGE-2 F1:        0.1760
ROUGE-L F1:        0.4353
语义相似度:         0.3967
平均预测长度:       4.29 词
平均参考长度:       6.04 词
长度比率:          0.7100
============================================================

计算最终评估指标...

============================================================
模型评估结果
============================================================
精确匹配准确率:     0.2830
Token级准确率:      0.1924
BLEU分数:          0.1603
ROUGE-1 F1:        0.4376
ROUGE-2 F1:        0.1760
ROUGE-L F1:        0.4353
语义相似度:         0.3967
平均预测长度:       4.29 词
平均参考长度:       6.04 词
长度比率:          0.7100
============================================================
详细结果已保存到: eval_results/eval_mode1_h512_20250912_031509.json
结果CSV已保存到: eval_results/eval_mode1_h512_20250912_031509.csv
指标摘要已保存到: eval_results/eval_mode1_h512_20250912_031509_metrics.txt
结果已记录到wandb

评估完成，总耗时: 377.11 秒
